{"ast":null,"code":"import _classCallCheck from \"@babel/runtime/helpers/classCallCheck\";\nimport _createClass from \"@babel/runtime/helpers/createClass\";\nimport _inherits from \"@babel/runtime/helpers/inherits\";\nimport _possibleConstructorReturn from \"@babel/runtime/helpers/possibleConstructorReturn\";\nimport _getPrototypeOf from \"@babel/runtime/helpers/getPrototypeOf\";\nvar _jsxFileName = \"/Users/eliothyenne/Daneo/node_modules/react-native-root-siblings/lib/RootSiblings.js\";\n\nfunction _createSuper(Derived) { var hasNativeReflectConstruct = _isNativeReflectConstruct(); return function _createSuperInternal() { var Super = _getPrototypeOf(Derived), result; if (hasNativeReflectConstruct) { var NewTarget = _getPrototypeOf(this).constructor; result = Reflect.construct(Super, arguments, NewTarget); } else { result = Super.apply(this, arguments); } return _possibleConstructorReturn(this, result); }; }\n\nfunction _isNativeReflectConstruct() { if (typeof Reflect === \"undefined\" || !Reflect.construct) return false; if (Reflect.construct.sham) return false; if (typeof Proxy === \"function\") return true; try { Boolean.prototype.valueOf.call(Reflect.construct(Boolean, [], function () {})); return true; } catch (e) { return false; } }\n\nimport React, { Component } from 'react';\nimport StaticContainer from \"./StaticContainer\";\nimport { RootControllerChanges } from \"./RootController\";\n\nvar _default = function (_Component) {\n  _inherits(_default, _Component);\n\n  var _super = _createSuper(_default);\n\n  function _default(props) {\n    var _this;\n\n    _classCallCheck(this, _default);\n\n    _this = _super.call(this, props);\n    _this.updatedSiblings = new Set();\n    _this.siblingsPool = [];\n    _this.state = {\n      siblings: []\n    };\n    return _this;\n  }\n\n  _createClass(_default, [{\n    key: \"componentDidMount\",\n    value: function componentDidMount() {\n      var _this2 = this;\n\n      this.props.controller.setCallback(function (id, change) {\n        setImmediate(function () {\n          return _this2.commitChange(id, change);\n        });\n      });\n    }\n  }, {\n    key: \"componentDidUpdate\",\n    value: function componentDidUpdate() {\n      this.updatedSiblings.clear();\n    }\n  }, {\n    key: \"render\",\n    value: function render() {\n      return React.createElement(React.Fragment, null, this.props.children, this.renderSiblings());\n    }\n  }, {\n    key: \"commitChange\",\n    value: function commitChange(id, _ref) {\n      var _this3 = this;\n\n      var change = _ref.change,\n          element = _ref.element,\n          updateCallback = _ref.updateCallback;\n      var siblings = Array.from(this.siblingsPool);\n      var index = siblings.findIndex(function (sibling) {\n        return sibling.id === id;\n      });\n\n      if (change === RootControllerChanges.Remove) {\n        if (index > -1) {\n          siblings.splice(index, 1);\n        } else {\n          this.invokeCallback(updateCallback);\n          return;\n        }\n      } else if (change === RootControllerChanges.Update) {\n        if (index > -1) {\n          siblings.splice(index, 1, {\n            element: element,\n            id: id\n          });\n          this.updatedSiblings.add(id);\n        } else {\n          this.invokeCallback(updateCallback);\n          return;\n        }\n      } else {\n        if (index > -1) {\n          siblings.splice(index, 1);\n        }\n\n        siblings.push({\n          element: element,\n          id: id\n        });\n        this.updatedSiblings.add(id);\n      }\n\n      this.siblingsPool = siblings;\n      this.setState({\n        siblings: siblings\n      }, function () {\n        return _this3.invokeCallback(updateCallback);\n      });\n    }\n  }, {\n    key: \"invokeCallback\",\n    value: function invokeCallback(callback) {\n      if (callback) {\n        callback();\n      }\n    }\n  }, {\n    key: \"renderSiblings\",\n    value: function renderSiblings() {\n      var _this4 = this;\n\n      return this.state.siblings.map(function (_ref2) {\n        var id = _ref2.id,\n            element = _ref2.element;\n        return React.createElement(StaticContainer, {\n          key: \"root-sibling-\" + id,\n          shouldUpdate: _this4.updatedSiblings.has(id),\n          __self: _this4,\n          __source: {\n            fileName: _jsxFileName,\n            lineNumber: 74,\n            columnNumber: 21\n          }\n        }, _this4.wrapSibling(element));\n      });\n    }\n  }, {\n    key: \"wrapSibling\",\n    value: function wrapSibling(element) {\n      var renderSibling = this.props.renderSibling;\n\n      if (renderSibling) {\n        return renderSibling(element);\n      } else {\n        return element;\n      }\n    }\n  }]);\n\n  return _default;\n}(Component);\n\nexport { _default as default };","map":{"version":3,"sources":["../src/RootSiblings.tsx"],"names":[],"mappings":"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","sourceRoot":"","sourcesContent":["import React, { Component } from 'react';\nimport StaticContainer from './StaticContainer';\nimport { RootControllerChanges } from './RootController';\nexport default class extends Component {\n    constructor(props) {\n        super(props);\n        this.updatedSiblings = new Set();\n        this.siblingsPool = [];\n        this.state = {\n            siblings: []\n        };\n    }\n    componentDidMount() {\n        this.props.controller.setCallback((id, change) => {\n            setImmediate(() => this.commitChange(id, change));\n        });\n    }\n    componentDidUpdate() {\n        this.updatedSiblings.clear();\n    }\n    render() {\n        return (<>\n        {this.props.children}\n        {this.renderSiblings()}\n      </>);\n    }\n    commitChange(id, { change, element, updateCallback }) {\n        const siblings = Array.from(this.siblingsPool);\n        const index = siblings.findIndex(sibling => sibling.id === id);\n        if (change === RootControllerChanges.Remove) {\n            if (index > -1) {\n                siblings.splice(index, 1);\n            }\n            else {\n                this.invokeCallback(updateCallback);\n                return;\n            }\n        }\n        else if (change === RootControllerChanges.Update) {\n            if (index > -1) {\n                siblings.splice(index, 1, {\n                    element,\n                    id\n                });\n                this.updatedSiblings.add(id);\n            }\n            else {\n                this.invokeCallback(updateCallback);\n                return;\n            }\n        }\n        else {\n            if (index > -1) {\n                siblings.splice(index, 1);\n            }\n            siblings.push({\n                element,\n                id\n            });\n            this.updatedSiblings.add(id);\n        }\n        this.siblingsPool = siblings;\n        this.setState({\n            siblings\n        }, () => this.invokeCallback(updateCallback));\n    }\n    invokeCallback(callback) {\n        if (callback) {\n            callback();\n        }\n    }\n    renderSiblings() {\n        return this.state.siblings.map(({ id, element }) => {\n            return (<StaticContainer key={`root-sibling-${id}`} shouldUpdate={this.updatedSiblings.has(id)}>\n          {this.wrapSibling(element)}\n        </StaticContainer>);\n        });\n    }\n    wrapSibling(element) {\n        const { renderSibling } = this.props;\n        if (renderSibling) {\n            return renderSibling(element);\n        }\n        else {\n            return element;\n        }\n    }\n}\n//# sourceMappingURL=RootSiblings.js.map"]},"metadata":{},"sourceType":"module"}