{"ast":null,"code":"import _slicedToArray from \"@babel/runtime/helpers/slicedToArray\";\nimport _classCallCheck from \"@babel/runtime/helpers/classCallCheck\";\nimport _createClass from \"@babel/runtime/helpers/createClass\";\nvar _jsxFileName = \"/Users/eliothyenne/Daneo/node_modules/react-native-root-siblings/lib/RootSiblingsManager.js\";\nimport React, { useEffect, useState } from 'react';\nimport AppRegistry from \"react-native-web/dist/exports/AppRegistry\";\nimport ChildrenWrapper from \"./ChildrenWrapper\";\nimport wrapRootComponent from \"./wrapRootComponent\";\n\nvar siblingWrapper = function siblingWrapper(sibling) {\n  return sibling;\n};\n\nfunction renderSibling(sibling) {\n  return siblingWrapper(sibling);\n}\n\nif (!global.__rootSiblingsInjected && !global.__rootSiblingsDisabled) {\n  AppRegistry.setWrapperComponentProvider(function () {\n    return Root;\n  });\n  global.__rootSiblingsInjected = true;\n}\n\nexport function setSiblingWrapper(wrapper) {\n  siblingWrapper = wrapper;\n}\n\nvar _wrapRootComponent = wrapRootComponent(ChildrenWrapper, renderSibling),\n    Root = _wrapRootComponent.Root,\n    defaultManager = _wrapRootComponent.manager;\n\nvar uuid = 0;\nvar managerStack = [defaultManager];\nvar inactiveManagers = new Set();\n\nfunction getActiveManager() {\n  for (var i = managerStack.length - 1; i >= 0; i--) {\n    var manager = managerStack[i];\n\n    if (!inactiveManagers.has(manager)) {\n      return manager;\n    }\n  }\n\n  return defaultManager;\n}\n\nvar RootSiblingsManager = function () {\n  function RootSiblingsManager(element, callback) {\n    _classCallCheck(this, RootSiblingsManager);\n\n    this.id = \"root-sibling-\" + (uuid + 1);\n    this.manager = getActiveManager();\n    this.manager.update(this.id, element, callback);\n    uuid++;\n  }\n\n  _createClass(RootSiblingsManager, [{\n    key: \"update\",\n    value: function update(element, callback) {\n      this.manager.update(this.id, element, callback);\n    }\n  }, {\n    key: \"destroy\",\n    value: function destroy(callback) {\n      this.manager.destroy(this.id, callback);\n    }\n  }]);\n\n  return RootSiblingsManager;\n}();\n\nexport { RootSiblingsManager as default };\nexport function RootSiblingParent(props) {\n  var inactive = props.inactive;\n\n  var _useState = useState(function () {\n    var _wrapRootComponent2 = wrapRootComponent(ChildrenWrapper, renderSibling),\n        parentRoot = _wrapRootComponent2.Root,\n        parentManager = _wrapRootComponent2.manager;\n\n    managerStack.push(parentManager);\n\n    if (inactive) {\n      inactiveManagers.add(parentManager);\n    }\n\n    return {\n      Root: parentRoot,\n      manager: parentManager\n    };\n  }),\n      _useState2 = _slicedToArray(_useState, 1),\n      sibling = _useState2[0];\n\n  useEffect(function () {\n    return function () {\n      if (sibling) {\n        var index = managerStack.indexOf(sibling.manager);\n\n        if (index > 0) {\n          managerStack.splice(index, 1);\n        }\n      }\n    };\n  }, [sibling]);\n\n  if (inactive && sibling && !inactiveManagers.has(sibling.manager)) {\n    inactiveManagers.add(sibling.manager);\n  } else if (!inactive && sibling && inactiveManagers.has(sibling.manager)) {\n    inactiveManagers.delete(sibling.manager);\n  }\n\n  var Parent = sibling.Root;\n  return React.createElement(Parent, {\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 75,\n      columnNumber: 12\n    }\n  }, props.children);\n}\nexport function RootSiblingPortal(props) {\n  var _useState3 = useState(function () {\n    return new RootSiblingsManager(null);\n  }),\n      _useState4 = _slicedToArray(_useState3, 1),\n      sibling = _useState4[0];\n\n  sibling.update(props.children);\n  useEffect(function () {\n    if (sibling) {\n      return function () {\n        return sibling.destroy();\n      };\n    }\n  }, [sibling]);\n  return null;\n}","map":{"version":3,"sources":["../src/RootSiblingsManager.tsx"],"names":[],"mappings":"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","sourceRoot":"","sourcesContent":["import React, { useEffect, useState } from 'react';\nimport { AppRegistry } from 'react-native';\nimport ChildrenWrapper from './ChildrenWrapper';\nimport wrapRootComponent from './wrapRootComponent';\nlet siblingWrapper = sibling => sibling;\nfunction renderSibling(sibling) {\n    return siblingWrapper(sibling);\n}\nif (!global.__rootSiblingsInjected && !global.__rootSiblingsDisabled) {\n    AppRegistry.setWrapperComponentProvider(() => {\n        return Root;\n    });\n    global.__rootSiblingsInjected = true;\n}\nexport function setSiblingWrapper(wrapper) {\n    siblingWrapper = wrapper;\n}\nconst { Root, manager: defaultManager } = wrapRootComponent(ChildrenWrapper, renderSibling);\nlet uuid = 0;\nconst managerStack = [defaultManager];\nconst inactiveManagers = new Set();\nfunction getActiveManager() {\n    for (let i = managerStack.length - 1; i >= 0; i--) {\n        const manager = managerStack[i];\n        if (!inactiveManagers.has(manager)) {\n            return manager;\n        }\n    }\n    return defaultManager;\n}\nexport default class RootSiblingsManager {\n    constructor(element, callback) {\n        this.id = `root-sibling-${uuid + 1}`;\n        this.manager = getActiveManager();\n        this.manager.update(this.id, element, callback);\n        uuid++;\n    }\n    update(element, callback) {\n        this.manager.update(this.id, element, callback);\n    }\n    destroy(callback) {\n        this.manager.destroy(this.id, callback);\n    }\n}\nexport function RootSiblingParent(props) {\n    const { inactive } = props;\n    const [sibling] = useState(() => {\n        const { Root: parentRoot, manager: parentManager } = wrapRootComponent(ChildrenWrapper, renderSibling);\n        managerStack.push(parentManager);\n        if (inactive) {\n            inactiveManagers.add(parentManager);\n        }\n        return {\n            Root: parentRoot,\n            manager: parentManager\n        };\n    });\n    useEffect(() => {\n        return () => {\n            if (sibling) {\n                const index = managerStack.indexOf(sibling.manager);\n                if (index > 0) {\n                    managerStack.splice(index, 1);\n                }\n            }\n        };\n    }, [sibling]);\n    if (inactive && sibling && !inactiveManagers.has(sibling.manager)) {\n        inactiveManagers.add(sibling.manager);\n    }\n    else if (!inactive && sibling && inactiveManagers.has(sibling.manager)) {\n        inactiveManagers.delete(sibling.manager);\n    }\n    const Parent = sibling.Root;\n    return <Parent>{props.children}</Parent>;\n}\nexport function RootSiblingPortal(props) {\n    const [sibling] = useState(() => new RootSiblingsManager(null));\n    sibling.update(props.children);\n    useEffect(() => {\n        if (sibling) {\n            return () => sibling.destroy();\n        }\n    }, [sibling]);\n    return null;\n}\n//# sourceMappingURL=RootSiblingsManager.js.map"]},"metadata":{},"sourceType":"module"}